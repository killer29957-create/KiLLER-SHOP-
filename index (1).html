<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>KiLLER SHOP</title>
<style>
body { font-family: Tahoma; direction: rtl; background:#111; color:#fff; margin:0; }
header { background: rgba(0,0,0,0.85); padding:15px; display:flex; justify-content:space-between; align-items:center; border-bottom:2px solid #0f0; }
.logo { font-size:22px; color:#0f0; font-weight:bold; }
.nav-buttons { display:flex; gap:8px; flex-wrap:wrap; }
.hidden { display:none; }
.page { display:none; padding:20px; max-width:500px; margin:20px auto; background:#222; border-radius:10px; }
input, select { width:100%; padding:8px; margin:5px 0; border-radius:6px; border:none; background:#333; color:#fff; }
button { padding:8px 16px; border:none; border-radius:6px; background:#0f0; color:#000; cursor:pointer; }
button:hover { background:#0c0; }
#notification { position: fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:#0f0; color:#000; padding:10px 20px; border-radius:8px; display:none; font-weight:bold; z-index:9999; text-align:center; }
.log-item { margin-bottom:10px; border-bottom:1px solid #333; padding-bottom:5px; }
.balance-box { background:#000; padding:10px; margin-bottom:10px; border-radius:10px; color:#0f0; font-weight:bold; text-align:center; }
</style>
</head>
<body>
<div id="notification"></div>
<header>
<div class="logo">ğŸ’° KiLLER SHOP</div>
<div class="nav-buttons hidden" id="navButtons">
<button onclick="showPage('shopPage')">Ø´Ø­Ù†</button>
<button onclick="showPage('depositPage')">Ø¥ÙŠØ¯Ø§Ø¹</button>
<button onclick="showPage('adminPage')">Ù‚Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±</button>
<button onclick="showPage('logPage')">Ø§Ù„Ø³Ø¬Ù„</button>
<button onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
</div>
</header>

<div class="page" id="loginPage">
<h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
<input type="email" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"><br>
<input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"><br>
<button id="loginBtn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
<p>Ù„Ø§ ØªÙ…Ù„Ùƒ Ø­Ø³Ø§Ø¨ØŸ <a href="#" id="toSignup">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</a></p>
</div>

<div class="page" id="signupPage">
<h2>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</h2>
<input type="text" id="signupName" placeholder="Ø§Ù„Ø§Ø³Ù…"><br>
<input type="email" id="signupEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"><br>
<input type="password" id="signupPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"><br>
<button id="signupBtn">ØªØ³Ø¬ÙŠÙ„</button>
<p>Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <a href="#" id="toLogin">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a></p>
</div>

<div class="page" id="shopPage">
<h2>Ø´Ø±Ø§Ø¡ Ø¬ÙˆØ§Ù‡Ø± ÙˆØ¹Ø¶ÙˆÙŠØ§Øª</h2>
<form id="purchaseForm">
<select id="package"></select>
<input type="text" id="playerID" placeholder="ID Ø§Ù„Ù„Ø§Ø¹Ø¨"><br>
<button type="submit">Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø´Ø±Ø§Ø¡</button>
</form>
</div>

<div class="page" id="depositPage">
<h2>Ø¥ÙŠØ¯Ø§Ø¹ Ø±ØµÙŠØ¯</h2>
<label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹: Ø³ÙŠØ±ÙŠØ§ØªÙŠÙ„ ÙƒØ§Ø´</label>
<div><span id="cashNumber">96617866</span> <button onclick="copyCash()">Ù†Ø³Ø® Ø§Ù„Ø±Ù‚Ù…</button></div>
<form id="depositForm">
<input type="number" id="amount" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº $" step="0.01"><br>
<div>ğŸ’µ Ø³ÙŠØ±ÙŠØ§ØªÙŠÙ„ ÙƒØ§Ø´: <span id="dollarSyria">11500</span> Ù„.Ø³</div>
<input type="text" id="depositorID" placeholder="ID Ø§Ù„Ù„Ø§Ø¹Ø¨"><br>
<input type="text" id="transactionID" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ©"><br>
<button type="submit">Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø¥ÙŠØ¯Ø§Ø¹</button>
</form>
</div>

<div class="page" id="adminPage">
<h2>âš™ï¸ Ù‚Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±</h2>
<h3>Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø´Ø­Ù† ÙˆØ§Ù„Ø¥ÙŠØ¯Ø§Ø¹ Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</h3>
<div id="pendingOrders"></div>
<h3>ØªØ¹Ø¯ÙŠÙ„ Ø³Ø¹Ø± Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±</h3>
<input type="number" id="newRate"><button onclick="changeRate()">Ø­ÙØ¸</button>
<h3>ØªØ¹Ø¯ÙŠÙ„ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¬ÙˆØ§Ù‡Ø± ÙˆØ§Ù„Ø¹Ø¶ÙˆÙŠØ§Øª</h3>
<div id="packagesEdit"></div>
</div>

<div class="page" id="logPage">
<div class="balance-box">Ø±ØµÙŠØ¯ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ: <span id="balance"></span></div>
<h2>Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</h2>
<div id="log"></div>
</div>

<script>
let users = JSON.parse(localStorage.getItem('users')) || {};
let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
let pendingOrders = JSON.parse(localStorage.getItem('pendingOrders')) || [];
let settings = JSON.parse(localStorage.getItem('settings')) || {dollarRate:11500, packages:[
{name:'100 Ø¬ÙˆÙ‡Ø±Ø©', price:1},{name:'200 Ø¬ÙˆÙ‡Ø±Ø©', price:2},{name:'300 Ø¬ÙˆÙ‡Ø±Ø©', price:3},{name:'Ø¹Ø¶ÙˆÙŠØ© Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©', price:2},{name:'Ø¹Ø¶ÙˆÙŠØ© Ø´Ù‡Ø±ÙŠØ©', price:10}]
};

function showNotification(msg){
    let n=document.getElementById('notification');
    n.innerText=msg; n.style.display='block';
    setTimeout(()=>{n.style.display='none';},2000);
}

function showPage(id){
    document.querySelectorAll('.page').forEach(p=>p.style.display='none');
    if(id==='adminPage' && (!currentUser||currentUser.email!=='killer29957@gmail.com')) return;
    document.getElementById(id).style.display='block';
    renderLog(); renderPending(); updateBalance();
}

function logout(){
    currentUser=null; localStorage.removeItem('currentUser'); 
    document.getElementById('navButtons').classList.add('hidden'); 
    showPage('loginPage');
}

function copyCash(){
    navigator.clipboard.writeText(document.getElementById('cashNumber').innerText); 
    showNotification('ØªÙ… Ø§Ù„Ù†Ø³Ø®');
}

function updateBalance(){
    if(currentUser){
        let balanceLS = users[currentUser.email].balance || 0;
        let balanceUSD = (balanceLS / settings.dollarRate).toFixed(2);
        document.getElementById('balance').innerText=`${balanceLS} Ù„.Ø³ (${balanceUSD} $)`;
    }
}

function renderPackages(){
    const sel=document.getElementById('package'); sel.innerHTML='';
    settings.packages.forEach(p=>{
        let priceLS = p.price * settings.dollarRate;
        let o=document.createElement('option'); 
        o.value=p.name; 
        o.dataset.price=p.price;
        o.textContent=`${p.name} - $${p.price} (${priceLS} Ù„.Ø³)`; 
        sel.appendChild(o);
    });
}

function renderPackagesEdit(){
    if(!currentUser||currentUser.email!=='killer29957@gmail.com') return;
    let c=document.getElementById('packagesEdit'); c.innerHTML='';
    settings.packages.forEach((p,i)=>{
        let priceLS = p.price * settings.dollarRate;
        let d=document.createElement('div');
        d.innerHTML=`${p.name}: $<input type='number' value='${p.price}' id='pkg_${i}' style='width:50px'> (${priceLS} Ù„.Ø³) <button onclick='savePackage(${i})'>Ø­ÙØ¸</button>`;
        c.appendChild(d);
    });
}

function savePackage(i){
    let val=parseFloat(document.getElementById(`pkg_${i}`).value); if(isNaN(val)) return;
    settings.packages[i].price=val;
    localStorage.setItem('settings',JSON.stringify(settings));
    renderPackages(); renderPackagesEdit();
    showNotification(`ØªÙ… ØªØ¹Ø¯ÙŠÙ„ ${settings.packages[i].name} Ø¥Ù„Ù‰ $${val}`);
}

function changeRate(){
    let r=parseFloat(document.getElementById('newRate').value); if(isNaN(r)) return;
    settings.dollarRate=r; localStorage.setItem('settings',JSON.stringify(settings));
    showNotification(`ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø³Ø¹Ø± Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± Ø¥Ù„Ù‰ ${r}`);
    updateDepositDisplay(); updateBalance(); renderPackages(); renderPackagesEdit();
}

function getSyriaCash(amount){return amount*settings.dollarRate;}

function updateDepositDisplay(){
    let amt=parseFloat(document.getElementById('amount').value)||0;
    document.getElementById('dollarSyria').innerText=getSyriaCash(amt);
}

// Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
function renderLog(){
    if(!currentUser) return;
    let logDiv=document.getElementById('log'); logDiv.innerHTML='';
    let logs=users[currentUser.email].log||[];
    let balanceLS = users[currentUser.email].balance || 0;
    let balanceUSD = (balanceLS / settings.dollarRate).toFixed(2);
    document.getElementById('balance').innerText=`${balanceLS} Ù„.Ø³ (${balanceUSD} $)`;
    logs.forEach(l=>{
        let d=document.createElement('div'); d.className='log-item';
        let amountUSD = (l.amount / settings.dollarRate).toFixed(2);
        d.textContent=`${l.date} - ${l.type}: ${l.amount} Ù„.Ø³ (${amountUSD} $) (${l.details})`;
        logDiv.appendChild(d);
    });
}

// Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
function renderPending(){
    if(!currentUser||currentUser.email!=='killer29957@gmail.com') return;
    let div=document.getElementById('pendingOrders'); div.innerHTML='';
    pendingOrders.forEach((o,i)=>{
        let d=document.createElement('div'); 
        d.style.border='1px solid #0f0'; d.style.margin='5px'; d.style.padding='5px';
        d.innerHTML=`${o.type} - ${o.user} - ${o.amount} Ù„.Ø³ (${o.details}) 
        <button onclick="approveOrder(${i})">Ù…ÙˆØ§ÙÙ‚Ø©</button> 
        <button onclick="rejectOrder(${i})">Ø±ÙØ¶</button>`;
        div.appendChild(d);
    });
}

// Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨
function approveOrder(i){
    let o=pendingOrders[i];
    if(!users[o.user].balance) users[o.user].balance=0;
    if(o.type==='Ø¥ÙŠØ¯Ø§Ø¹') users[o.user].balance+=o.amount;
    if(o.type==='Ø´Ø±Ø§Ø¡') users[o.user].balance-=o.amount;
    if(!users[o.user].log) users[o.user].log=[];
    users[o.user].log.push({date:new Date().toLocaleString(), type:o.type, amount:o.amount, details:o.details});
    localStorage.setItem('users',JSON.stringify(users));
    pendingOrders.splice(i,1); localStorage.setItem('pendingOrders',JSON.stringify(pendingOrders));
    renderPending(); renderLog(); updateBalance(); showNotification('ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©');
}

function rejectOrder(i){
    pendingOrders.splice(i,1); localStorage.setItem('pendingOrders',JSON.stringify(pendingOrders));
    renderPending(); showNotification('ØªÙ… Ø§Ù„Ø±ÙØ¶');
}

// Signup and Login
document.getElementById('signupBtn').addEventListener('click',()=>{
    let name=document.getElementById('signupName').value.trim();
    let email=document.getElementById('signupEmail').value.trim();
    let pass=document.getElementById('signupPassword').value.trim();
    if(!name||!email||!pass){showNotification('Ø£Ø¯Ø®Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„'); return;}
    if(users[email]){showNotification('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„'); return;}
    users[email]={name:name,password:pass,balance:0,log:[]}; localStorage.setItem('users',JSON.stringify(users));
    showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨'); showPage('loginPage');
});

document.getElementById('loginBtn').addEventListener('click',()=>{
    let email=document.getElementById('email').value.trim();
    let pass=document.getElementById('password').value.trim();
    if(!users[email] || users[email].password!==pass){showNotification('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©'); return;}
    currentUser={email:email}; localStorage.setItem('currentUser',JSON.stringify(currentUser));
    document.getElementById('navButtons').classList.remove('hidden'); updateBalance(); renderPackages(); renderPackagesEdit(); showPage('shopPage');
});

document.getElementById('toSignup').addEventListener('click',(e)=>{e.preventDefault(); showPage('signupPage');});
document.getElementById('toLogin').addEventListener('click',(e)=>{e.preventDefault(); showPage('loginPage');});

// Ø§Ù„Ø´Ø±Ø§Ø¡ Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯
document.getElementById('purchaseForm').addEventListener('submit',(e)=>{
    e.preventDefault();
    if(!currentUser) return;
    let pkg=document.getElementById('package').value;
    let price=parseFloat(document.getElementById('package').selectedOptions[0].dataset.price)*settings.dollarRate;
    let playerID=document.getElementById('playerID').value.trim();
    let userBalance = users[currentUser.email].balance || 0;
    if(!playerID){showNotification('Ø£Ø¯Ø®Ù„ ID Ø§Ù„Ù„Ø§Ø¹Ø¨'); return;}
    if(price > userBalance){showNotification('Ø§Ù„Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙ Ù„Ù„Ø´Ø­Ù†'); return;}
    pendingOrders.push({type:'Ø´Ø±Ø§Ø¡',user:currentUser.email,amount:price,details:`${pkg} - ID ${playerID}`});
    localStorage.setItem('pendingOrders',JSON.stringify(pendingOrders)); renderPending(); showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø±Ø§Ø¡ Ù„Ù„Ù…ÙˆØ§ÙÙ‚Ø©');
});

// Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹
document.getElementById('depositForm').addEventListener('submit',(e)=>{
    e.preventDefault();
    if(!currentUser) return;
    let amt=parseFloat(document.getElementById('amount').value)||0;
    let playerID=document.getElementById('depositorID').value.trim();
    let txn=document.getElementById('transactionID').value.trim();
    if(!playerID || !txn || amt<=0){showNotification('Ø£ÙƒÙ…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„'); return;}
    pendingOrders.push({type:'Ø¥ÙŠØ¯Ø§Ø¹',user:currentUser.email,amount:getSyriaCash(amt),details:`ID ${playerID} - TX ${txn}`});
    localStorage.setItem('pendingOrders',JSON.stringify(pendingOrders)); renderPending(); showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ Ù„Ù„Ù…ÙˆØ§ÙÙ‚Ø©');
});

// Initialize
document.addEventListener('DOMContentLoaded',()=>{
    if(currentUser){
        document.getElementById('navButtons').classList.remove('hidden'); 
        updateBalance(); renderPackages(); renderPackagesEdit(); showPage('shopPage');
    } else {showPage('loginPage');}
});

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø¨Ù„Øº ÙÙŠ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹
document.getElementById('amount').addEventListener('input', updateDepositDisplay);
</script>
</body>
</html>